{"version":3,"sources":["webpack:///./src/js/services/QuestionnaireDataService.js"],"names":["QuestionnaireDataService","questionnaireID","csrfToken","query","GraphQLRequestHelper","request","json","submissionHash","_","get","DEFAULT_NETWORK_ERROR","memberData","questionnaireData","siteData","title","subtitle","keyInformation","user","name","role","email","submissionFixture"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AACA;AACA;;IAEqBA,wB;;;;;;;;;;;;+CAEqBC,e,EAAyBC,S;;;;;;AACzDC,qB,2EAEwCF,e;;uBAK3BG,mEAAoB,CAACC,OAArB,CAA6B;AAACF,uBAAK,EAALA,KAAD;AAAQD,2BAAS,EAATA;AAAR,iBAA7B,C;;;AAAbI,oB;AACAC,8B,GAAiBC,6CAAC,CAACC,GAAF,CAAMH,IAAN,EAAY,yCAAZ,EAAuD,IAAvD,C;;oBAClBC,c;;;;;sBACGG,uE;;;iDAGDH,c;;;;;;;;;;;;;;;;;;;;;gDAGmBN,e;;;;;;AACpBE,qB,iIAQgBF,e;;uBAWHG,mEAAoB,CAACC,OAArB,CAA6B;AAACF,uBAAK,EAALA;AAAD,iBAA7B,C;;;AAAbG,oB;AACAK,0B,GAAaH,6CAAC,CAACC,GAAF,CAAMH,IAAN,EAAY,0BAAZ,EAAwC,IAAxC,C;AACbM,iC,GAAoBJ,6CAAC,CAACC,GAAF,CAAMH,IAAN,EAAY,wBAAZ,EAAsC,IAAtC,C;AACpBO,wB,GAAWL,6CAAC,CAACC,GAAF,CAAMH,IAAN,EAAY,uBAAZ,EAAqC,IAArC,C;;sBAEd,CAACK,UAAD,IAAe,CAACC,iBAAhB,IAAqC,CAACC,Q;;;;;sBACjCH,uE;;;kDAGD;AACLI,uBAAK,EAAEN,6CAAC,CAACC,GAAF,CAAMG,iBAAN,EAAyB,MAAzB,EAAiC,EAAjC,CADF;AAELG,0BAAQ,EAAEP,6CAAC,CAACC,GAAF,CAAMI,QAAN,EAAgB,OAAhB,EAAyB,EAAzB,CAFL;AAGLZ,iCAAe,EAAEO,6CAAC,CAACC,GAAF,CAAMG,iBAAN,EAAyB,IAAzB,EAA+B,EAA/B,CAHZ;AAILI,gCAAc,EAAER,6CAAC,CAACC,GAAF,CAAMG,iBAAN,EAAyB,gBAAzB,EAA2C,EAA3C,CAJX;AAKLK,sBAAI,EAAE;AACJC,wBAAI,YAAKV,6CAAC,CAACC,GAAF,CAAME,UAAN,EAAkB,WAAlB,CAAL,cAAuCH,6CAAC,CAACC,GAAF,CAAME,UAAN,EAAkB,SAAlB,CAAvC,CADA;AAEJQ,wBAAI,EAAEX,6CAAC,CAACC,GAAF,CAAME,UAAN,EAAkB,UAAlB,CAFF;AAGJS,yBAAK,EAAEZ,6CAAC,CAACC,GAAF,CAAME,UAAN,EAAkB,OAAlB;AAHH;AALD,iB;;;;;;;;;;;;;;;;;;;;;gDAawBJ,c;;;;;kDAExBc,8E","file":"hot/hot-update.js","sourcesContent":["// @flow\n\nimport type {QuestionnaireStartState, QuestionnaireSubmissionState} from \"../store/QuestionnaireState\";\nimport GraphQLRequestHelper from \"../utils/GraphQLRequestHelper\";\nimport _ from \"lodash\";\nimport {DEFAULT_NETWORK_ERROR} from \"../constants/errors\";\nimport submissionFixture from \"../../../__fixtures__/QuestionnaireSubmissionState\";\n\nexport default class QuestionnaireDataService {\n\n  static async createInProgressSubmission(questionnaireID: string, csrfToken: string): Promise<string> {\n    const query = `\nmutation {\n createQuestionnaireSubmission(QuestionnaireID: ${questionnaireID}){\n   UUID\n }\n}`;\n\n    const json = await GraphQLRequestHelper.request({query, csrfToken});\n    const submissionHash = _.get(json, \"data.createQuestionnaireSubmission.UUID\", null);\n    if (!submissionHash) {\n      throw DEFAULT_NETWORK_ERROR;\n    }\n\n    return submissionHash;\n  }\n\n  static async fetchStartData(questionnaireID: string): Promise<QuestionnaireStartState> {\n    const query = `\nquery {\n  readCurrentMember {\n    Email\n    FirstName\n    Surname\n    UserRole\n  }\n  readQuestionnaire(ID: ${questionnaireID}) {\n    ID\n    Name\n    KeyInformation\n  }\n  readSiteConfig {\n    Title\n  }\n}\n`;\n\n    const json = await GraphQLRequestHelper.request({query});\n    const memberData = _.get(json, \"data.readCurrentMember.0\", null);\n    const questionnaireData = _.get(json, \"data.readQuestionnaire\", null);\n    const siteData = _.get(json, \"data.readSiteConfig.0\", null);\n\n    if(!memberData || !questionnaireData || !siteData) {\n      throw DEFAULT_NETWORK_ERROR;\n    }\n\n    return {\n      title: _.get(questionnaireData, \"Name\", \"\"),\n      subtitle: _.get(siteData, \"Title\", \"\"),\n      questionnaireID: _.get(questionnaireData, \"ID\", \"\"),\n      keyInformation: _.get(questionnaireData, \"KeyInformation\", \"\"),\n      user: {\n        name: `${_.get(memberData, \"FirstName\")} ${_.get(memberData, \"Surname\")}`,\n        role: _.get(memberData, \"UserRole\"),\n        email: _.get(memberData, \"Email\"),\n      },\n    };\n  }\n\n  static async fetchSubmissionData(submissionHash: string): Promise<QuestionnaireSubmissionState> {\n    // TODO: fetch real data\n    return submissionFixture;\n  }\n}\n"],"sourceRoot":""}